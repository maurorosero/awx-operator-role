---
# Namespace where the AWX Operator and AWX instance will reside.
awx_operator_namespace: awx

# Version of the AWX Operator to deploy via upstream manifests.
awx_operator_version: "2.19.1"

# Upstream release artifact (tarball) and extraction path for the AWX Operator sources.
awx_operator_release_url: "https://github.com/ansible/awx-operator/archive/refs/tags/{{ awx_operator_version }}.tar.gz"
awx_operator_release_archive: "/tmp/awx-operator-{{ awx_operator_version }}.tar.gz"
awx_operator_bundle_path: "/opt/awx-operator-{{ awx_operator_version }}"
awx_operator_kustomize_path: "{{ awx_operator_bundle_path }}/config/default"

# Admin user expected to interact with Kubernetes (inherits Ansible remote user).
awx_operator_admin_user: "{{ ansible_user }}"

# Path to the kubeconfig used to manage the cluster.
awx_operator_kubeconfig: "/home/{{ awx_operator_admin_user }}/.kube/config"

# Name of the AWX custom resource instance to create.
awx_instance_name: awx

# Spec to apply to the AWX custom resource. Override in playbook/group/host vars as needed.
awx_instance_spec:
  service_type: ClusterIP
  ingress_type: none

# Wait configuration for AWX web deployment readiness (in seconds).
awx_wait_timeout: 900
awx_wait_delay: 15

# Extra time (seconds) to wait for the AWX operator pods to stabilize.
awx_operator_wait_timeout: 600

# Whether to gather and print pod/service status for troubleshooting.
awx_operator_display_status: true

# Hostname or IP advertised when suggesting AWX access (defaults to target host).
awx_operator_access_host: "{{ hostvars[inventory_hostname].ansible_host | default(inventory_hostname) }}"

# Local port to use when suggesting port-forward instructions for ClusterIP services.
awx_operator_port_forward_port: 8043

# Enable automatic setup of a systemd-managed port-forward service for ClusterIP exposure.
awx_operator_port_forward_enabled: true

# Additional arguments for the kubectl port-forward command (spaced string).
awx_operator_port_forward_extra_args: "--address 0.0.0.0"

# --- HTTPS / Ingress TLS (when awx_use_https is true) ---
awx_use_https: false
awx_ingress_hostname: ""
awx_ingress_tls_secret: ""
# Cloudflare DNS-01: dns_provider=cloudflare, credenciales en acme_plugin_data (solo desde SOPS).
dns_provider: ""
acme_plugin_data: ""
# cert_manager=true: cert-manager HTTP-01 sin Cloudflare.
cert_manager: false
# ACME (Let's Encrypt) cuando cert_manager o Cloudflare.
awx_ingress_acme_email: ""
awx_ingress_acme_server: "https://acme-v02.api.letsencrypt.org/directory"
# Ruta a certificados: el rol crea el Secret TLS desde estos archivos.
awx_ingress_tls_cert_path: ""
awx_ingress_tls_key_path: ""
# Validación de cert en post_tasks (default true con HTTPS; false con autofirmado).
awx_controller_validate_certs: true

# cert-manager: versión a instalar cuando cert_manager es true o dns_provider es cloudflare.
cert_manager_version: "v1.19.2"
cert_manager_manifest_url: "https://github.com/cert-manager/cert-manager/releases/download/{{ cert_manager_version }}/cert-manager.yaml"

# Esperar al Secret TLS creado por cert-manager antes de desplegar el CR AWX (emisión puede tardar varios minutos).
awx_ingress_wait_for_tls_secret: true
# 36 × 10 s ≈ 6 min; ajustar con awx_ingress_wait_tls_retries si hace falta más.
awx_ingress_wait_tls_retries: 36
awx_ingress_wait_tls_delay: 10

